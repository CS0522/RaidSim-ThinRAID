<!--
 * @Author: Chen Shi
 * @Date: 2023-11-23 11:19:11
 * @Description: 
-->
## 需要实现的模块

ThinRAID 架构

![](readme.assets/thinraid.png)

### 解决方案


## 知识点小记

### LS 和 LA

![](readme.assets/raid5layout.png)

* 对称
  
  将每个 stripe 中的第一个数据放在校验和的后面，然后再往后排列，需要时再绕回第一个磁盘往后放；这种对称的数据排列方式就能始终按照磁盘的顺序依次下来。

* 不对称
  
  将数据从左到右，按顺序直接排下来存储（图中的左不对称和右不对称的前后数据不对称）


1. 由于实际读写 Raid5 时命令时均匀发到每个磁盘上的，因此对称方式在处理大块值的连续 I/O 读时有更好的性能，实际测试中对随机 I/O 性能也有提升；

2. Left-symmetric 作为 Raid5 默认的分布算法，也是对于读请求性能最佳的数据分布机制；

3. 数据分布机制带来的性能差异，相对于 Raid5 中的磁盘个数以及 stripe 条带大小参数来说是比较细微的。


## 待解决问题日志

24.01.18 前都没有记载了。

### 24.01.18

* ~~req_interval 读取的时候会间隔一个读取，少读取一些 reqs~~

* 磁盘之间负载不均衡，占用率低但反而 IO 次数高

* enabled 的经过时间大于 disabled 的经过时间


### 24.01.21

* 磁盘之间负载不均衡，占用率低但反而 IO 次数高

* ~~enabled 的经过时间大于 disabled 的经过时间~~

* ~~打印输出 block table~~

* ~~打印输出 hots~~

* ~~同一条带的待迁移数据块不能随机放在新添加磁盘上~~

* req_requests 为 0 的时候的过滤（❌）

* ~~es 数据迁移算法的验证~~


### 24.01.29

* 添加磁盘休眠时间

* ~~trace 内请求磁盘号修改~~

* ~~trace 内偏移地址按比例放缩（ 10000 * 原偏移地址 / 最大偏移地址，并保证处理后地址小于 10000，不会超过范围）~~

* ~~IOCollector 传入 Config 实例~~